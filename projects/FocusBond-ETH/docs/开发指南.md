# FocusBond 开发指南

## 🚀 快速开始

### 环境要求
- Node.js 18+
- Foundry (Forge)
- Git

### 一键启动
```bash
# 克隆项目
git clone https://github.com/Jim3503/FocusBond-ETH.git
cd FocusBond-ETH

# 一键启动所有服务
./run.sh

# 访问应用: http://localhost:3000
```

## 🏗️ 项目结构

```
FocusBond-ETH/
├── contracts/          # 智能合约
├── apps/web-evm/      # 前端应用
├── packages/sdk-evm/  # SDK 包
├── scripts/           # 部署脚本
└── test/             # 测试文件
```

## 🔧 开发环境设置

### 1. 安装依赖
```bash
# 安装 Foundry
curl -L https://foundry.paradigm.xyz | bash
foundryup

# 安装 Node.js 依赖
pnpm install
```

### 2. 启动本地区块链
```bash
# 启动 Anvil 本地区块链
anvil --port 8545 --gas-price 500000000
```

### 3. 部署合约
```bash
# 部署合规版本合约
forge script script/DeployCompliant.s.sol --rpc-url http://127.0.0.1:8545 --private-key 0xac0974bec39a17e36ba4a6b4d238ff944bacb478cbed5efcae784d7bf4f2ff80 --broadcast
```

### 4. 启动前端
```bash
cd apps/web-evm
npm run dev
```

## 🧪 测试

### 合约测试
```bash
# 运行所有测试
forge test

# 运行特定测试
forge test --match-test testCreateSession
```

### 前端测试
```bash
cd apps/web-evm
npm test
```

## 📝 开发规范

### Git 工作流
- `main`: 生产环境分支
- `dev`: 开发集成分支  
- `feat/*`: 功能分支

### 提交规范
```
<类型>: <描述>

类型:
- feat: 新功能
- fix: 修复bug
- docs: 文档更新
- chore: 维护性工作
- refactor: 代码重构
- test: 测试相关
```

### 代码审查
- 所有合并到 dev 的代码都需要经过审查
- 合并到 main 的代码需要更严格的审查
- 及时响应审查意见并修改

## 🔍 调试指南

### 常见问题
1. **Nonce 错误**: 重启 Anvil 区块链
2. **合约地址不匹配**: 检查配置文件中的地址
3. **钱包连接失败**: 确保 MetaMask 已安装并连接到正确网络

### 调试工具
- 使用 `cast` 命令与合约交互
- 查看浏览器控制台日志
- 使用 Foundry 的调试功能

## 📚 相关文档

- [README.md](../README.md) - 项目概述
- [START_HERE.md](../START_HERE.md) - 快速开始指南
- [合约文档](../contracts/README.md) - 智能合约说明